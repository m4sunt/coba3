<script type="text/javascript"> var gk_isXlsx = false; var gk_xlsxFileLookup = {}; var gk_fileData = {}; function filledCell(cell) { return cell !== '' && cell != null; } function loadFileData(filename) { if (gk_isXlsx && gk_xlsxFileLookup[filename]) { try { var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' }); var firstSheetName = workbook.SheetNames[0]; var worksheet = workbook.Sheets[firstSheetName]; // Convert sheet to JSON to filter blank rows var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' }); // Filter out blank rows (rows where all cells are empty, null, or undefined) var filteredData = jsonData.filter(row => row.some(filledCell)); // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row var headerRowIndex = filteredData.findIndex((row, index) => row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length ); // Fallback if (headerRowIndex === -1 || headerRowIndex > 25) { headerRowIndex = 0; } // Convert filtered JSON back to CSV var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays csv = XLSX.utils.sheet_to_csv(csv, { header: 1 }); return csv; } catch (e) { console.error(e); return ""; } } return gk_fileData[filename] || ""; } </script><!DOCTYPE html> <html lang="id"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="theme-color" content="#007bff" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" /> <meta name="apple-mobile-web-app-title" content="BukuTamu" /> <link rel="apple-touch-icon" href="icon-192.png" /> <link rel="manifest" href="manifest.json" /> <title>Buku Tamu Digital</title> <style> body { font-family: sans-serif; max-width: 700px; margin: auto; padding: 20px; } label { font-weight: bold; } select, input { width: 100%; padding: 8px; margin-top: 5px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px; } .hidden { display: none; } .required { color: red; } .error { border: 2px solid red; } .success { border: 2px solid green; } .warning { background-color: #fff3cd; border: 1px solid #ffeaa7; padding: 10px; margin: 10px 0; border-radius: 5px; color: #856404; } button { cursor: pointer; padding: 10px 20px; border-radius: 5px; border: none; font-size: 16px; } #btnForm { background: #007bff; color: white; } #btnData { background: #6c757d; color: white; } #btnExport { background: #17a2b8; color: white; } #btnClearAll { background: #dc3545; color: white; } #btnSimpan { font-size: 18px; width: 100%; padding: 12px; background: #28a745; color: white; } </style> </head> <body> <h1>BUKU TAMU INSPEKTORAT DAERAH</h1> <div style="margin-bottom: 20px; display: flex; gap: 10px;"> <button type="button" id="btnForm">üìù Form Input</button> <button type="button" id="btnData">üìä Lihat Data (<span id="dataCount">0</span>)</button> <button type="button" id="btnExport">üíæ Export Data</button> </div> <div id="formSection"> <form id="bukuTamuForm" onsubmit="return false;"> <label>Nama: <span class="required">*</span></label> <input id="nama" required type="text" /><br /><br /> <label>INSTANSI/ASAL: <span class="required">*</span></label> <select id="asal" required> <option value="">-- Pilih Asal --</option> <option value="INSTANSI">INSTANSI/UNIT KERJA</option> <option value="MASYARAKAT">MASYARAKAT</option> </select><br /><br /> <div class="hidden" id="daftarInstansi"> <label>DAFTAR INSTANSI/UNIT KERJA: <span class="required">*</span></label> <select id="instansi"> <option value="">-- Pilih Instansi --</option> <option>SEKRETARIAT DAERAH</option> <option>SEKRETARIAT DPRD</option> <option>BADAN PERENCANAAN PEMBANGUNAN DAERAH</option> <option>BADAN PENGELOLAAN KEUANGAN DAN ASET DAERAH</option> <option>BADAN PENGELOLAAN PAJAK DAN RETRIBUSI DAERAH</option> <option>BADAN KEPEGAWAIAN DAN PENGEMBANGAN SUMBER DAYA MANUSIA</option> <option>BADAN KESATUAN BANGSA DAN POLITIK DAERAH</option> <option>BADAN PENANGGULANGAN BENCANA DAERAH</option> <option>DINAS LINGKUNGAN HIDUP</option> <option>DINAS KESEHATAN</option> <option>DINAS KEPENDUDUKAN DAN PENCATATAN SIPIL</option> <option>DINAS KOPERASI, UMKM, PERINDUSTRIAN DAN PERDAGANGAN</option> <option>DINAS SOSIAL</option> <option>DINAS PEMUDA, OLAHRAGA DAN PARIWISATA</option> <option>DINAS KOMUNIKASI DAN INFORMATIKA</option> <option>DINAS PERUMAHAN, KAWASAN PERMUKIMAN DAN PERTANAHAN</option> <option>DINAS PENANAMAN MODAL DAN PELAYANAN PERIZINAN TERPADU SATU PINTU</option> <option>DINAS PENDIDIKAN DAN KEBUDAYAAN</option> <option>DINAS KETAHANAN PANGAN</option> <option>DINAS PEMBERDAYAAN MASYARAKAT DAN TIYUH</option> <option>DINAS PEMBERDAYAAN PEREMPUAN DAN PERLINDUNGAN ANAK</option> <option>DINAS PENGENDALIAN PENDUDUK DAN KELUARGA BERENCANA</option> <option>DINAS PERHUBUNGAN</option> <option>DINAS PERTANIAN</option> <option>DINAS PETERNAKAN DAN KESEHATAN HEWAN</option> <option>DINAS PEKERJAAN UMUM DAN PENATAAN RUANG</option> <option>DINAS TENAGA KERJA DAN TRANSMIGRASI</option> <option>DINAS PERIKANAN</option> <option>DINAS PERPUSTAKAAN DAN KEARSIPAN</option> <option>DINAS PEMADAM KEBAKARAN DAN PENYELAMATAN</option> <option>SATUAN POLISI PAMONG PRAJA</option> <option>BADAN PENGAWASAN KEUANGAN DAN PEMBANGUNAN (BPKP)</option> <option>LAINNYA</option> </select><br /><br /> </div> <div class="hidden" id="daftarMasyarakat"> <label>Kecamatan: <span class="required">*</span></label> <select id="kecamatan"> <option value="">-- Pilih Kecamatan --</option> <option value="Tulang Bawang Tengah">Tulang Bawang Tengah</option> <option value="Tulang Bawang Udik">Tulang Bawang Udik</option> <option value="Gunung Terang">Gunung Terang</option> <option value="Gunung Agung">Gunung Agung</option> <option value="Lambu Kibang">Lambu Kibang</option> <option value="Way Kenanga">Way Kenanga</option> <option value="Tumijajar">Tumijajar</option> <option value="Pagar Dewa">Pagar Dewa</option> <option value="Batu Putih">Batu Putih</option> </select><br /><br /> <label>Desa/Tiyuh: <span class="required">*</span></label> <select id="desa"> <option value="">-- Pilih Desa --</option> </select><br /><br /> </div> <label>PIHAK YANG DITEMUI: <span class="required">*</span></label> <select id="pihakDitemui" required> <option value="">-- Pilih Pihak yang Ditemui --</option> <option>INSPEKTUR</option> <option>SEKRETARIS</option> <option>IRBANSUS</option> <option>IRBAN 1</option> <option>IRBAN 2</option> <option>IRBAN 3</option> <option>IRBAN 4</option> </select><br /><br /> <label>JENIS LAYANAN: <span class="required">*</span></label> <select id="jenisLayanan" required> <option value="">-- Pilih Jenis Layanan --</option> <option>Permintaan Audit/Klarifikasi Khusus</option> <option>Penanganan Pengaduan</option> <option>Layanan Informasi Publik</option> <option>Pembinaan & Konsultasi</option> <option>Audit</option> <option>Review</option> <option>Evaluasi/Monitoring</option> <option>Tindak Lanjut Temuan</option> </select><br /><br /> <label>URAIAN: <span class="required">*</span></label> <input id="uraian" required type="text" /><br /><br /> <label>NOMOR HP: <span class="required">*</span></label> <input id="nomorHp" inputmode="numeric" pattern="\d*" required type="text" /><br /><br /> <label>Tanda Tangan: <span class="required">*</span></label> <div class="warning hidden" id="signatureWarning">‚ö†Ô∏è Tanda tangan wajib diisi!</div> <canvas id="signature-pad" style="border:1px solid #ccc; width: 100%; border-radius: 4px;"></canvas><br /> <button type="button" id="btnClearSignature" style="margin-top: 5px;">üßπ Bersihkan</button><br /><br /> <label>Foto: <span class="required">*</span></label> <div class="warning hidden" id="photoWarning">‚ö†Ô∏è Foto wajib diambil atau diunggah!</div> <video id="video" width="300" height="225" autoplay muted playsinline style="border:1px solid #ccc;"></video><br /> <canvas id="canvas" width="300" height="225" style="display:none;"></canvas> <button type="button" id="btnAmbilFoto" style="margin-top: 10px;">üì∏ Ambil Foto</button> <input type="file" id="fotoUpload" accept="image/*" style="margin-top: 10px;" /><br /><br /> <img id="previewFoto" style="width:300px;display:none;border:1px solid #ccc;margin-bottom:10px;" alt="Hasil Foto"> <button type="button" id="btnSimpan">üíæ Simpan Data</button> </form> </div> <div id="dataSection" class="hidden"> <h2>üìä DATA BUKU TAMU</h2> <div style="margin-bottom: 20px;"> <button type="button" id="btnClearAll">üóëÔ∏è Hapus Semua Data</button> </div> <div id="dataContainer"></div> </div> <script> if ('serviceWorker' in navigator) { navigator.serviceWorker.register('service-worker.js') .then(reg => console.log("Service worker terdaftar:", reg)) .catch(err => console.error("Gagal daftar SW:", err)); }
